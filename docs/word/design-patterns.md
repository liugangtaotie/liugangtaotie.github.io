---
title: 第六章、设计模式
author: liugang
date: 2020-11-08
tags:
 - tag4
categories:
 - category1
---

<Boxx  changeTime="5000"/>  

## 1. 单一职责原则

Single Responsibility Principle, SRP

### 含义：一个对象应该只包含单一的职责，并且该职责被完整地封装在一个类中

单一职责原则分析

* 一个类(大到模块，小到方法)承担的职责越多，它被复用的可能性就越小
* 当一个职责变化时，可能会影响其他职责的运作
* 将这些职责进行分离，将不同的职责封装在不同的类中
* 将不同的变化原因封装在不同的类中
* 单一职责原则是实现高内聚、低耦合的指导方针。

## 2. 开闭原则

Open-Closed Principle, OCP

面向对象的可复用设计的第一块基石

### 含义：软件实体应当对扩展开放，对修改关闭

开闭原则分析

* 开闭原则由Bertrand Meyer于1988年提出。
* 在开闭原则的定义中，软件实体可以是一个软件模块、一个由多个类组成的局部结构或一个独立的类
* 开闭原则是指软件实体应尽量在不修改原有代码的情况下进行扩展
* 抽象化是开闭原则的关键
* 相对稳定的抽象层+灵活的具体层
* 对可变性封装原则：找到系统的可变因素并将其封装起来

## 3. 里式代换原则

Liskov Substitution Principle, LSP

### 含义：所有引用基类的地方必须能透明地使用其子类的对象

里氏代换原则分析

* 在软件中将一个基类对象替换成它的子类对象，程序将不会产生任何错误和异常。
* 反过来则不一定成立，如果一个软件实体使用的是一个子类对象的话，那么它不一定能够使用基类对象。
* 在程序中尽量使用基类类型来对对象进行定义，而在运行时再确定其子类类型。

## 4. 依赖倒转原则

Dependence Inversion Principle, DIP

### 含义：高层模块不应该依赖低层模块，它们都应该依赖抽象。抽象不应该依赖于细节，细节应该依赖于抽象

依赖倒转原则分析

* 在程序代码中传递参数时或在关联关系中，尽量引用层次高的抽象层类，即使用接口和抽象类进行变量类型声明、参数类型声明、方法返回类型声明，以及数据类型的转换等。
* 在程序中尽量使用抽象层进行编程，而将具体类写在配置文件中。
* 针对抽象层编程，将具体类的对象通过依赖注入的方式注入到其他对象。

## 5. 接口隔离原则

Interface Segregation Principle,ISP

### 含义：客户端不应该依赖那些它不需要的接口

接口隔离原则分析

* 当一个接口太大时，需要将它分割成一些更细小的接口
* 使用该接口的客户端仅需知道与之相关的方法即可
* 每一个接口应该承担一种相对独立的角色，不干不该干的事，该干的事都要干。
* “接口”定义(1)：一个类型所提供的所有方法特征的集合。一个接口代表一个角色，每个角色都有它特定的一个接口，角色隔离原则。
* “接口”定义(2)：侠义的特定语言的接口。接口仅仅提供客户端需要的行为，客户端不需要的行为则隐藏起来，应该为客户端提供尽可能小的单独的接口，而不需要提供大的总接口，每个接口中只包含一个客户端所需的方法，“定制服务”。

## 6. 组合复用原则

Composite Reuse Principle,CRP

### 含义：优先使用对象组合，而不是继承来达到复用的目的

合成复用原则分析

* 合成复用原则就是在一个新的对象里通过关联关系(包括组合关系和聚合关系)来使用一些已有的对象，使之成为新对象的一部分。
* 新对象通过委派调用已有对象的方法达到复用功能的目的。
* 复用时要尽量使用组合/聚合关系(关联关系)，少用继承。
* 继承复用：实现简单，易于扩展。破坏系统的封装性；从基类继承而来的实现是静态的，不可能在运行时发生改变，没有足够的灵活性；只能在有限的环境中使用。(“白箱”复用)
* 组合/聚合复用：耦合度相对较低，有选择性地调用成员对象的操作；可以在运行时动态进行，新对象可以动态地引用与成员对象类型相同的其他对象。(“黑箱”复用)

## 7. 迪米特原则

Law of Demeter, LoD

### 含义：每一个软件单位对其他的单位都只有最少的知识，而且局限于那些与本单位密切相关的软件单位

迪米特法则分析

* 迪米特法则来自于1987年美国东北大学一个名为“Demeter”的研究项目。
* 迪米特法则要求一个软件实体应当尽可能少地与其他实体发生相互作用
* 应用迪米特法则可降低系统的耦合度，使类与类之间保持松散的耦合关系。
* 迪米特法则要求在设计系统时，应当尽量减少对象之间的交互
* 如果两个对象之间不必彼此直接通信，那么这两个对象就不应该发生任何直接的相互作用
* 如果其中一个对象需要调用另一个对象的方法，可以通过“第三者”转发这个调用
* 通过引入一个合理的“第三者”(中间类)来降低现有对象之间的耦合度。

特点：外观模式、中介者模式、接口隔离原则

## 发布 － 订阅模式

```js
/**
 * 发布 － 订阅模式
 */
//定义一个新闻发布平台
//主要功能包括任务发布大厅(informationWarehouse)，以及订阅任务(subscribe)，发布任务(release)
let task = {
  informationWarehouse: {},
  subscribe(key, fn) {
      if (typeof this.informationWarehouse[key] === "undefined") {
          this.informationWarehouse[key] = []
      }
      this.informationWarehouse[key].push(fn) // 订阅的消息推送到调度中心
  },
  release(type, news) {
      let fns = this.informationWarehouse[type]
      // 如果调度中心没有这个资源，返回结束
      if (typeof fns === "undefined" || fns.length === 0) return;
      fns.forEach(fn => {
          fn(news);
      })
  }
}
console.log("----- 订阅 -----");
// 订阅 娱乐头条
task.subscribe('娱乐', val => {
  console.log('小王订阅的娱乐头条', JSON.stringify(val))
})
// 订阅 科技头条
task.subscribe('科技', val => {
  console.log('小刘订阅的科技头条', JSON.stringify(val))
})
// 订阅 历史头条
task.subscribe('历史', val => {
  console.log('小李订阅的历史头条', JSON.stringify(val))
})
/**
* 系统推送头条
*/
console.log("----- 发布 -----");
task.release('娱乐', {
  title: "大衣哥给儿媳妇红包的言外之意",
  url: "https://www.toutiao.com/a6966769740203262478"
})
task.release('科技', {
  title: "192号段发放在即 中国广电5G渐近",
  url: "https://www.toutiao.com/a6966480940277334535"
})
task.release('历史', {
  title: "袁隆平的父母何许人也？",
  url: "https://www.toutiao.com/a6966099280075424267"
})
console.log("调度中心", task.informationWarehouse);
```

## 推荐的官方文档

[面向对象设计原则](https://juejin.im/post/6844904078535819272)
