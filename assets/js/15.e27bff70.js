(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{548:function(s,a,t){s.exports=t.p+"assets/img/subpackageOne.7dead07d.jpeg"},549:function(s,a,t){s.exports=t.p+"assets/img/subpackageTwo.8c955618.jpeg"},550:function(s,a,t){s.exports=t.p+"assets/img/subpackageFour.31648542.jpeg"},551:function(s,a,t){s.exports=t.p+"assets/img/subpackageThree.4aea6024.jpeg"},552:function(s,a,t){s.exports=t.p+"assets/img/package-size.24035fbf.png"},553:function(s,a,t){s.exports=t.p+"assets/img/package-dist.16ab769a.jpeg"},636:function(s,a,t){"use strict";t.r(a);var e=t(2),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("Boxx",{attrs:{changeTime:"5000"}}),s._v(" "),a("h2",{attrs:{id:"一、分包策略"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、分包策略"}},[s._v("#")]),s._v(" 一、分包策略")]),s._v(" "),a("h3",{attrs:{id:"_1-1-路由内增加"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-路由内增加"}},[s._v("#")]),s._v(" 1.1 路由内增加")]),s._v(" "),a("p",[s._v("isSubPackage 当前页面是否分包\nsubPackageRoot  分包路径配置")]),s._v(" "),a("p",[s._v("demo")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"onlineConsult/meeting"')]),s._v(",\n   style: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     navigationBarTitleText: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"进入视频"')]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   isSubPackage: true,\n   subPackageRoot: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pages/onlineConsultIM"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n\n 设置好运行yarn g，重新生成pages.json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h3",{attrs:{id:"_1-2-策略的由来"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-策略的由来"}},[s._v("#")]),s._v(" 1.2 策略的由来")]),s._v(" "),a("ul",[a("li",[s._v("根据官网和uview代码目录结构如下：")])]),s._v(" "),a("h4",{attrs:{id:"官网源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#官网源码"}},[s._v("#")]),s._v(" 官网源码")]),s._v(" "),a("p",[a("img",{attrs:{src:t(548),alt:"Image text"}})]),s._v(" "),a("h4",{attrs:{id:"uview源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uview源码"}},[s._v("#")]),s._v(" uview源码")]),s._v(" "),a("p",[a("img",{attrs:{src:t(549),alt:"Image text"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("分析得出：在pages下面的页面基本不用移动，策略放入route里面进行")])]),s._v(" "),a("li",[a("p",[s._v("解决方案如下：")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"onlineConsult/meeting"')]),s._v(",\n   style: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     navigationBarTitleText: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"进入视频"')]),s._v(",\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n   isSubPackage: true,\n   subPackageRoot: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pages/onlineConsultIM"')]),s._v(",\n "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  path: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(",\n  style: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    navigationBarTitleText: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"预约挂号"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  isSubPackage: true,\n  subPackageRoot: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pages/appointment"')]),s._v(",\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("pages下面根据实际情况，进行分包，命名可以为:packageA 等")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(550),alt:"Image text"}})]),s._v(" "),a("ul",[a("li",[s._v("需要在route/index.ts 里面把相关注释标注好,这样方便查找并进行尺寸大小的计算")])]),s._v(" "),a("p",[a("img",{attrs:{src:t(551),alt:"Image text"}})]),s._v(" "),a("h2",{attrs:{id:"二、-如何优化性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、-如何优化性能"}},[s._v("#")]),s._v(" 二、 如何优化性能")]),s._v(" "),a("ul",[a("li",[s._v("打包优化：\n目前前端使用的uniapp 比较火，毕竟基于Vue，上手快成本低，还能兼容APP、h5、和小程序，但是随着项目的开发迭代，项目越来越大。")])]),s._v(" "),a("p",[s._v("我们肯定首先想到的便是分包，但是后来发现治标不治本，主包还是很大，于是便对打包后的文件逐一排查")]),s._v(" "),a("h3",{attrs:{id:"_2-1-首先进入微信打包文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-首先进入微信打包文件"}},[s._v("#")]),s._v(" 2.1 首先进入微信打包文件")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("cd dist"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("dev"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("weixin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_2-2-审查文件大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-审查文件大小"}},[s._v("#")]),s._v(" 2.2 审查文件大小")]),s._v(" "),a("h4",{attrs:{id:"_2-2-1-mac-查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-1-mac-查看"}},[s._v("#")]),s._v(" 2.2.1 mac 查看")]),s._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("du "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-2-2-windows-查看"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-2-windows-查看"}},[s._v("#")]),s._v(" 2.2.2 windows 查看")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("站点上资源\n"),a("a",{attrs:{href:"http://t.zoukankan.com/gered-p-10208281.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("windows某个目录下所有文件/文件夹的大小"),a("OutboundLink")],1)])]),s._v(" "),a("li",[a("p",[s._v("实践之后如下图:")])])]),s._v(" "),a("p",[a("img",{attrs:{src:t(552),alt:"Image text"}})]),s._v(" "),a("h3",{attrs:{id:"_2-3-发现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-发现"}},[s._v("#")]),s._v(" 2.3 发现")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("发现每个 wxss 文件都很大，打开发现每个wxss文件都有重复的公共css，而这些css 都是放到根目录uni.scss文件里的")])]),s._v(" "),a("li",[a("p",[s._v("特别注意：")])])]),s._v(" "),a("p",[a("img",{attrs:{src:t(553),alt:"Image text"}})]),s._v(" "),a("ul",[a("li",[s._v("分析：1+2+3 , 3个包将近150k,其实xx-common-ui有类似的组件，完全可以进行替换；")]),s._v(" "),a("li",[s._v("总结：xx-common-ui有类似的组件，就不用再写业务组件，除非当前业务没有办法满足，必须要写一个。")])]),s._v(" "),a("h3",{attrs:{id:"_2-4-解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-解决"}},[s._v("#")]),s._v(" 2.4 解决")]),s._v(" "),a("p",[s._v("知道问题所在就好办了，uni.scss 里面变量可以保留，而其他的css 都放到app.vue里面就可以了")]),s._v(" "),a("ul",[a("li",[s._v("总结：")]),s._v(" "),a("li",[s._v("1、减少页面级渲染")]),s._v(" "),a("li",[s._v("2、能用CSS解决的，不要用JS")]),s._v(" "),a("li",[s._v("3、减少M级图片，在保证分辨率的同时，尽量压缩图片")]),s._v(" "),a("li",[s._v("4、减少包的体积，去掉不必要的图片，字体文件备份文件等")])]),s._v(" "),a("h2",{attrs:{id:"推荐的官方文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#推荐的官方文档"}},[s._v("#")]),s._v(" 推荐的官方文档")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/wOGMqir2FHejq78MaZGuiA",target:"_blank",rel:"noopener noreferrer"}},[s._v("给小程序再减重 30% 的秘密​（京喜小程序首页瘦身实践）"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/css-modules/css-modules",target:"_blank",rel:"noopener noreferrer"}},[s._v("CSS Modules"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/MrRaindrop/tree-cli",target:"_blank",rel:"noopener noreferrer"}},[s._v("Tree-Cli"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/_NSJTQ-4-8gTnwTVK-tn0A",target:"_blank",rel:"noopener noreferrer"}},[s._v("小程序工程化探索"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/wlanye/article/details/73457700",target:"_blank",rel:"noopener noreferrer"}},[s._v("微信小程序 限制 2M 的瘦身技巧与方法详解"),a("OutboundLink")],1)])],1)}),[],!1,null,null,null);a.default=n.exports}}]);